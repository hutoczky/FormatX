/* LCARS bridge-like animated background panels
   Colors inherit from existing theme variables. */

.bridge-screens {
  position: absolute;
  inset: 0;
  pointer-events: none;
  display: grid;
  grid-template-areas:
    "strip strip strip"
    "hud   hud   list"
    "eq    wave  list";
  grid-template-rows: 70px 1fr 180px;
  grid-template-columns: 2fr 1.2fr 0.8fr;
  gap: 18px;
  padding: 18px;
  padding-top: 44px; /* Increased from 38px to 44px for 10-12px breathing room below dual rails (24px + 4px + ~16px) */
}

.bridge-screens .screen {
  background: rgba(6, 12, 24, 0.25); /* Reduced from 0.3 (~17% reduction) */
  border: 1px solid rgba(0, 234, 255, 0.16); /* Reduced from 0.19 (~16% reduction) */
  border-radius: 14px;
  box-shadow: 0 12px 40px rgba(0, 0, 0, .2) inset, 0 4px 22px rgba(0, 234, 255, .05); /* Reduced glow further */
  overflow: hidden;
  position: relative;
  will-change: transform; /* Performance hint */
}

/* 1) Top status strip: moving multicolor blocks */
.screen.top-strip { grid-area: strip; }
.screen.top-strip::before {
  content: "";
  position: absolute; inset: 0;
  background:
    repeating-linear-gradient(
      to right,
      var(--primary) 0 24px,
      transparent 24px 28px
    ),
    repeating-linear-gradient(
      to right,
      var(--accent) 0 18px,
      transparent 18px 24px
    ),
    repeating-linear-gradient(
      to right,
      var(--primary-2) 0 14px,
      transparent 14px 18px
    );
  mix-blend-mode: screen;
  animation: strip-shift 32s linear infinite; /* Slower: 30s -> 32s (~7% slower for total ~20% reduction) */
  opacity: .55; /* Reduced from .6 (~8% reduction for total ~20% reduction) */
  will-change: background-position;
}
@keyframes strip-shift {
  0% { background-position: 0 0, -120px 0, 90px 0; }
  100% { background-position: 1280px 0, 1160px 0, 980px 0; }
}

/* 2) Central HUD radar */
.screen.main-hud { grid-area: hud; }
.screen.main-hud svg {
  width: 100%; height: 100%;
  display: block;
  filter: drop-shadow(0 0 8px rgba(0,234,255,.35));
}
.hud-ring { fill: none; stroke: rgba(0,234,255,.4); }
.hud-ring.thick { stroke-width: 2.5; }
.hud-ring.faint { stroke: rgba(0,234,255,.18); stroke-dasharray: 4 6; }

.hud-grid { stroke: rgba(0,234,255,.12); stroke-width: 1; }

.hud-sweep {
  stroke: var(--primary);
  stroke-width: 2.2;
  transform-origin: 50% 50%;
  animation: hud-rotate 8s linear infinite; /* Slower: 7s -> 8s (~14% slower for total ~20% reduction) */
  filter: drop-shadow(0 0 6px var(--primary));
  will-change: transform;
}
@keyframes hud-rotate { to { transform: rotate(360deg); } }

.hud-pulse {
  fill: #fff;
  transform-origin: 50% 50%;
  animation: hud-pulse 3.2s ease-in-out infinite; /* Slower: 2.8s -> 3.2s (~14% slower for total ~20% reduction) */
  opacity: .68; /* Reduced from .72 (~6% reduction for total ~20% reduction) */
  filter: drop-shadow(0 0 12px rgba(0,234,255,.55));
  will-change: transform;
}
@keyframes hud-pulse {
  0%,100% { transform: scale(.95); }
  50% { transform: scale(1.1); }
}

/* 3) Waveform scope */
.screen.wave { grid-area: wave; }
.screen.wave svg { width: 100%; height: 100%; display: block; }
.wave-path {
  fill: none;
  stroke: var(--accent);
  stroke-width: 2;
  stroke-dasharray: 8 12;
  animation: wave-run 3.4s linear infinite; /* Slower: 3s -> 3.4s (~13% slower for total ~20% reduction) */
  filter: drop-shadow(0 0 6px rgba(255, 209, 102, .6));
  will-change: stroke-dashoffset;
}
@keyframes wave-run { to { stroke-dashoffset: -200; } }

/* 4) Equalizer bars */
.screen.eq { grid-area: eq; display: grid; align-items: end; grid-auto-flow: column; grid-auto-columns: minmax(6px, 1fr); gap: 6px; padding: 10px; }
.eq .bar {
  height: 30%;
  background: linear-gradient(180deg, var(--primary), var(--primary-2));
  box-shadow: 0 0 12px rgba(0,234,255,.35);
  border-radius: 4px 4px 0 0;
  animation: equalize 1260ms ease-in-out infinite; /* Slower: 1100ms -> 1260ms (~15% slower for total ~20% reduction) */
  transform-origin: bottom center;
  opacity: .72; /* Reduced from .77 (~6% reduction for total ~20% reduction) */
  will-change: transform;
}
.eq .bar:nth-child(odd) { animation-duration: 1450ms; } /* Slower: 1270ms -> 1450ms (~14% slower) */
.eq .bar:nth-child(3n) { animation-duration: 1090ms; } /* Slower: 950ms -> 1090ms (~15% slower) */
.eq .bar:nth-child(5n) { animation-duration: 1650ms; } /* Slower: 1440ms -> 1650ms (~15% slower) */
@keyframes equalize {
  0%,100% { transform: scaleY(.25); }
  45%     { transform: scaleY(.96); }
  60%     { transform: scaleY(.6); }
}

/* 5) Vertical data list with scanning highlight */
.screen.list { grid-area: list; }
.list::before, .list::after {
  content:"";
  position:absolute; left:0; right:0; height:22%;
  background: linear-gradient(90deg, transparent, rgba(0,234,255,.11), transparent); /* Reduced from .13 (~15% reduction) */
  filter: blur(1px);
  will-change: transform;
}
.list::before { top:-22%; animation: scan-down 8s linear infinite; } /* Slower: 7s -> 8s (~14% slower for total ~20% reduction) */
.list::after  { bottom:-22%; animation: scan-up   8s linear infinite; animation-delay: -2.4s; } /* Slower: 7s -> 8s */
@keyframes scan-down { to { transform: translateY(122%); } }
@keyframes scan-up   { to { transform: translateY(-122%); } }

.list .col {
  position:absolute; top:0; bottom:0; width: calc(33.333% - 12px);
  background:
    repeating-linear-gradient(to bottom, rgba(0,234,255,.28) 0 1px, transparent 1px 21px);
  border-right: 1px solid rgba(0,234,255,.2);
}
.list .col:nth-child(1) { left: 0; }
.list .col:nth-child(2) { left: calc(33.333% + 6px); }
.list .col:nth-child(3) { right: 0; border-right: 0; }

/* blinking dots in list */
.list .dot {
  position: absolute; left: 10px; width: 6px; height: 6px; border-radius: 50%;
  background: var(--accent);
  box-shadow: 0 0 8px rgba(255,209,102,.85);
  animation: dot-blink 2.1s ease-in-out infinite; /* Slower: 1.85s -> 2.1s (~14% slower for total ~20% reduction) */
  will-change: opacity;
}
@keyframes dot-blink { 0%,100%{opacity:.25} 50%{opacity:1} }

/* 6) Simple starship-like schematic (neutral, non-branded) */
.screen.schematic { position: absolute; width: 34%; aspect-ratio: 16/9; right: 24px; top: 24px; opacity: .7; }
.screen.schematic svg { width: 100%; height: 100%; display: block; }
.ship-stroke { fill: none; stroke: var(--primary); stroke-width: 2; filter: drop-shadow(0 0 6px rgba(0,234,255,.35)); }
.ship-fill   { fill: rgba(0,234,255,.18); stroke: var(--primary); stroke-width: 1; }

/* Responsiveness */
@media (max-width: 1100px) {
  .bridge-screens {
    grid-template-areas:
      "strip"
      "hud"
      "wave"
      "eq"
      "list";
    grid-template-rows: 60px auto 180px 140px 240px;
    grid-template-columns: 1fr;
  }
  .screen.schematic { position: absolute; right: 12px; top: 12px; width: 42%; }
}

/* Extra breathing room under LCARS strip */
@media (min-width: 860px){
  .bridge-screens{ padding-top: 44px; } /* Updated to match new breathing room */
}

/* Pause animations when tab is hidden (performance + battery saving) */
html:not([data-tab-visible="true"]) .bridge-screens .screen::before,
html:not([data-tab-visible="true"]) .bridge-screens .screen::after,
html:not([data-tab-visible="true"]) .screen.top-strip::before,
html:not([data-tab-visible="true"]) .hud-sweep,
html:not([data-tab-visible="true"]) .hud-pulse,
html:not([data-tab-visible="true"]) .wave-path,
html:not([data-tab-visible="true"]) .eq .bar,
html:not([data-tab-visible="true"]) .list::before,
html:not([data-tab-visible="true"]) .list::after,
html:not([data-tab-visible="true"]) .list .dot {
  animation-play-state: paused !important;
}

/* Comprehensive reduced motion support - disable ALL animations */
@media (prefers-reduced-motion: reduce) {
  .bridge-screens .screen::before,
  .bridge-screens .screen::after,
  .screen.top-strip::before,
  .hud-sweep,
  .hud-pulse,
  .wave-path,
  .eq .bar,
  .list::before,
  .list::after,
  .list .dot,
  .ship-stroke,
  .ship-fill {
    animation: none !important;
  }
  
  /* Static states for reduced motion */
  .hud-pulse {
    opacity: 0.7;
    transform: scale(1);
  }
  
  .eq .bar {
    transform: scaleY(0.5);
  }
  
  .list::before {
    top: 10%;
  }
  
  .list::after {
    bottom: 10%;
  }
  
  .list .dot {
    opacity: 0.6;
  }
}

/* ========================================
   LCARS Hero Graphic - Refined Display
   Scoped to LCARS theme only
   ======================================== */
/* Hide hero LCARS panel by default */
.hero-lcars-panel {
  display: none;
}

/* Show only in LCARS theme */
body.theme-lcars .hero-lcars-panel,
html[data-franchise-theme="lcars"] .hero-lcars-panel {
  display: block;
  position: absolute;
  width: 100%;
  max-width: 900px;
  aspect-ratio: 4/3;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  opacity: 0.35;
  pointer-events: none;
  z-index: 0;
}

body.theme-lcars .hero-lcars-panel svg,
html[data-franchise-theme="lcars"] .hero-lcars-panel svg {
  width: 100%;
  height: 100%;
  display: block;
}

/* Animate the sweep line */
body.theme-lcars .lcars-sweep,
html[data-franchise-theme="lcars"] .lcars-sweep {
  transform-origin: 50% 50%;
  animation: lcars-sweep-rotate 8s linear infinite;
}

@keyframes lcars-sweep-rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Pause sweep animation when tab is hidden */
html:not([data-tab-visible="true"]) .lcars-sweep {
  animation-play-state: paused !important;
}

/* Disable sweep animation for reduced motion */
@media (prefers-reduced-motion: reduce) {
  .lcars-sweep {
    animation: none !important;
  }
}

/* Hide original radar/ship on LCARS theme */
body.theme-lcars .screen.main-hud,
body.theme-lcars .screen.schematic,
html[data-franchise-theme="lcars"] .screen.main-hud,
html[data-franchise-theme="lcars"] .screen.schematic {
  display: none;
}